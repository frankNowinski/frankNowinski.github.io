<!doctype html>
<!--[if lt IE 7]><html class="no-js lt-ie9 lt-ie8 lt-ie7" lang="en"> <![endif]-->
<!--[if (IE 7)&!(IEMobile)]><html class="no-js lt-ie9 lt-ie8" lang="en"><![endif]-->
<!--[if (IE 8)&!(IEMobile)]><html class="no-js lt-ie9" lang="en"><![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en"><!--<![endif]-->
<head>
<meta charset="utf-8">
<title>Omniauth Facebook With Devise &#8211; Frank Nowinski</title>
<meta name="description" content="My personal blog.">
<meta name="keywords" content="">



<!-- Open Graph -->
<meta property="og:locale" content="en_US">
<meta property="og:type" content="article">
<meta property="og:title" content="Omniauth Facebook With Devise">
<meta property="og:description" content="My personal blog.">
<meta property="og:url" content="http://franknowinski.github.io/omniauth-facebook-with-devise/">
<meta property="og:site_name" content="Frank Nowinski">





<link rel="canonical" href="http://franknowinski.github.io/omniauth-facebook-with-devise/">
<link href="http://franknowinski.github.io/feed.xml" type="application/atom+xml" rel="alternate" title="Frank Nowinski Feed">

<!-- http://t.co/dKP3o1e -->
<meta name="HandheldFriendly" content="True">
<meta name="MobileOptimized" content="320">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<!-- For all browsers -->
<link rel="stylesheet" href="http://franknowinski.github.io/assets/css/main.css">
<!-- Webfonts -->
<link href="//fonts.googleapis.com/css?family=Lato:300,400,700,300italic,400italic" rel="stylesheet" type="text/css">

<meta http-equiv="cleartype" content="on">

<!-- Load Modernizr -->
<script src="http://franknowinski.github.io/assets/js/vendor/modernizr-2.6.2.custom.min.js"></script>

<!-- Icons -->
<!-- 16x16 -->
<link rel="shortcut icon" href="http://franknowinski.github.io/favicon.ico">
<!-- 32x32 -->
<link rel="shortcut icon" href="http://franknowinski.github.io/favicon.png">
<!-- 57x57 (precomposed) for iPhone 3GS, pre-2011 iPod Touch and older Android devices -->
<link rel="apple-touch-icon-precomposed" href="http://franknowinski.github.io/images/apple-touch-icon-precomposed.png">
<!-- 72x72 (precomposed) for 1st generation iPad, iPad 2 and iPad mini -->
<link rel="apple-touch-icon-precomposed" sizes="72x72" href="http://franknowinski.github.io/images/apple-touch-icon-72x72-precomposed.png">
<!-- 114x114 (precomposed) for iPhone 4, 4S, 5 and post-2011 iPod Touch -->
<link rel="apple-touch-icon-precomposed" sizes="114x114" href="http://franknowinski.github.io/images/apple-touch-icon-114x114-precomposed.png">
<!-- 144x144 (precomposed) for iPad 3rd and 4th generation -->
<link rel="apple-touch-icon-precomposed" sizes="144x144" href="http://franknowinski.github.io/images/apple-touch-icon-144x144-precomposed.png">



</head>

<body id="post" >

<!--[if lt IE 9]><div class="upgrade"><strong><a href="http://whatbrowser.org/">Your browser is quite old!</strong> Why not upgrade to a different browser to better enjoy this site?</a></div><![endif]-->
<nav id="dl-menu" class="dl-menuwrapper" role="navigation">
  <button class="dl-trigger">Open Menu</button>
  <ul class="dl-menu">
    <li><a href="http://franknowinski.github.io/">Home</a></li>
    <li>
      <a href="#">About</a>
      <ul class="dl-submenu">
        <li>
          <img src="http://franknowinski.github.io/images/cover-photo.jpg" alt="Frank Nowisnki photo" class="author-photo">
          <h4>Frank Nowisnki</h4>
          <p>My personal blog to express various coding obstacles I've faced on my journey to becoming a Web Developer.</p>
        </li>
        <li><a href="http://franknowinski.github.io/about/"><span class="btn btn-inverse">Learn More</span></a></li>
        <li>
          <a href="mailto:nowinski.frank@gmail.com"><i class="fa fa-fw fa-envelope"></i> Email</a>
        </li>
        
        
        
        
        <li>
          <a href="https://github.com/frankNowinski"><i class="fa fa-fw fa-github"></i> GitHub</a>
        </li>
        
        
        
        
      </ul><!-- /.dl-submenu -->
    </li>
    <li>
      <a href="#">Posts</a>
      <ul class="dl-submenu">
        <li><a href="http://franknowinski.github.io/posts/">All Posts</a></li>
        <li><a href="http://franknowinski.github.io/tags/">All Tags</a></li>
      </ul>
    </li>
    
      
          
      
      <li><a href="http://franknowinski.github.io/theme-setup/" >Theme Setup</a></li>
    
  </ul><!-- /.dl-menu -->
</nav><!-- /.dl-menuwrapper -->




<div id="main" role="main">
  <article class="hentry">
    <header class="header-title">
      <div class="header-title-wrap">
        
          <h1 class="entry-title"><a href="http://franknowinski.github.io/omniauth-facebook-with-devise/" rel="bookmark" title="Omniauth Facebook With Devise">Omniauth Facebook With Devise</a></h1>
        
        <h2><span class="entry-date date published"><time datetime="2016-02-21T19:25:01-05:00">February 21, 2016</time></span></h2>
        
        <p class="entry-reading-time">
          <i class="fa fa-clock-o"></i>
          
Reading time ~2 minutes
        </p><!-- /.entry-reading-time -->
        
      </div><!-- /.header-title-wrap -->
    </header>
    <div class="entry-content">
      <p>Initializing a User Using Omniauth-Facebook with Devise</p>

<p>Instead of putting the burden on yourself and your team for implementing an authentication feature for your app, many programmers are deflecting the responsibility to Tech Gaints such as Facebook, Google, and Twitter to securely log in their users. Besides saving your team from writing code, the major benefit of using another authentication provider is that your app becomes considerably more robust against security vulnerabilities.</p>

<p>Omniauth is the miraculous gem that allows you to use alternative authentication providers in your app. However, for the purpose of this blog, I’m going to demonstrate how you can use Omniauth with Devise, a popular gem used for user authentication.</p>

<p>First, you’ll need to include the following gems in your ‘Gemfile’:</p>

<div class="highlight"><pre><code class="language-ruby" data-lang="ruby">gem &#39;devise&#39;
gem &#39;omniauth-facebook&#39;</code></pre></div>

<p>Now run <code>bundle install</code></p>

<p>Next, create your User model with Devise by entering the following two commands in your terminal:</p>

<div class="highlight"><pre><code class="language-ruby" data-lang="ruby">rails generate devise:install
rails g devise User</code></pre></div>

<p>This will create a migration file for your User model with all the predefined attributes that ship with Devise. You can view all of these attributes by going to <code>db/migrate/20160215180931_devise_create_users.rb</code> (your file will have different numbers).</p>

<p>Before you run <code>rake db:migrate</code> you’ll need to create a new table to add two more attributes to the User model so you’ll be able to create User instances from data returned to you from Facebook.</p>

<p><code>rails g migration AddOmniauthToUsers provider:string uid:string</code></p>

<p>Now you can run <code>rake db:migrate</code></p>

<p>Earlier when you ran the two commands to install Devise into your rails application you created several files. One of those files was <code>config/initializers/devise.rb</code>. Head there so you can declare the authentication provider you’re using (Facebook) and declare your Facebook “APP_ID” and “APP_SECRET.”</p>

<p>Include in config/initializers/devise.rb:</p>

<p>config.omniauth :facebook, “APP_ID”, “APP_SECRET”</p>

<p>To get an ‘APP_ID’ and ‘APP_SECRET’  you’ll have to create an app at the Facebook Developers website https://developers.facebook.com/. If this is your first time creating a Facebook app then follow this guide: https://developers.facebook.com/docs/apps/register</p>

<p>In order for Devise to be aware that Omniauth exists in your application you’ll need to declare it. Go to your user model and input the following code:</p>

<p>devise :omniauthable, :omniauth providers =&gt; [:facebook]</p>

<p>This code will create the following routes or url methods:</p>

<p>user_omniauth_authorize_path(proivider)
user_omniauth_callback_path(proivider)</p>

<p>To activate the user_omniauth_authrorize_path you’ll need to display a link in your application. In the view where you would like your user to have the option to sign in through Facebook, input the following link:</p>

<p>&lt;%= link_to “Sign in with Facebook”, user_omniauth_authorize_path(:facebook) %&gt;</p>

<p>Although you won’t be explicitly calling the user_omniauth_callback_path, it’s essential to have in your app. After a user signs in through Facebook they are redirected to this url where you’ll have access to their data. To declare this callback url you’ll have to update your ‘config/routes.rb file:</p>

<p>devise_for :users, :controllers =&gt; { :omniauth_callbacks =&gt; “users/omniauth_callbacks” }</p>

<p>We’ve specified our url methods that we’ll need to use for our Facebook authentication so now we’ll need to create a controller. Label the controller file “app/controllers/users/omniauth_callbacks_controller.rb” and set up the file like so:</p>

<p>Copy users omniauth section</p>

<p>On line 4 inside the ‘facebook’ method you’ll notice we’re calling the ‘from_omniauth’ method on the User class. To utilize this method we’ll have to define it, so head over to app/models/user.rb and update your file with the following code:</p>

<p>From omniauth method</p>

<p>Inside this method we can extract data that is returned to us from Facebook and initialize a new User. The argument of this method (auth) is assigned:</p>

<p>{“provider”=&gt;”facebook”,
 “uid”=&gt;”10207528486042900”,
 “info”=&gt;{“name”=&gt;”Frank Nowinski”, “image”=&gt;”http://graph.facebook.com/10207528486042900/picture”},
 “credentials”=&gt;
  {“token”=&gt;
    “CAAMOIT5sGIcBALLCG7IZCcruM7RppvzNQWZClaC9fDtkgiYL1U0QlQVCfe7Euw1yPErZBq0j78osqaPrTZAHIkbGCl7bfiQLGRxLyfo2EI2v23jt4LNB1yCKjFQTA6z5ZC3c91l1kkHAEJU2J8PLj8ZAjF5WBNqC5d3oeEneZABLvxiCoUFFgZBhmMwwC6C0NfCwXVZAOwBJtAgZDZD”,
   “expires_at”=&gt;1461190586,
   “expires”=&gt;true},
 “extra”=&gt;{“raw_info”=&gt;{“name”=&gt;”Frank Nowinski”, “id”=&gt;”10207528486042900”}}}</p>

      <footer class="entry-meta">
        <span class="entry-tags"></span>
        
        <div class="social-share">
  <ul class="socialcount socialcount-small inline-list">
    <li class="facebook"><a href="https://www.facebook.com/sharer/sharer.php?u=http://franknowinski.github.io/omniauth-facebook-with-devise/" title="Share on Facebook"><span class="count"><i class="fa fa-facebook-square"></i> Like</span></a></li>
    <li class="twitter"><a href="https://twitter.com/intent/tweet?text=http://franknowinski.github.io/omniauth-facebook-with-devise/" title="Share on Twitter"><span class="count"><i class="fa fa-twitter-square"></i> Tweet</span></a></li>
    <li class="googleplus"><a href="https://plus.google.com/share?url=http://franknowinski.github.io/omniauth-facebook-with-devise/" title="Share on Google Plus"><span class="count"><i class="fa fa-google-plus-square"></i> +1</span></a></li>
  </ul>
</div><!-- /.social-share -->
      </footer>
    </div><!-- /.entry-content -->
    
    <div class="read-more">
  
    <div class="read-more-header">
      <a href="http://franknowinski.github.io/dynamic-dispatching/" class="read-more-btn">Read More</a>
    </div><!-- /.read-more-header -->
    <div class="read-more-content">
      <h3><a href="http://franknowinski.github.io/dynamic-dispatching/" title="Dynamic Dispatching Basics">Dynamic Dispatching Basics</a></h3>
      <p>Besides the added benefit of writing more concise and considerably less code, metaprogramming has many other advantages as well. Possibly...&hellip; <a href="http://franknowinski.github.io/dynamic-dispatching/">Continue reading</a></p>
    </div><!-- /.read-more-content -->
  
  <div class="read-more-list">
    
      <div class="list-item">
        <h4><a href="http://franknowinski.github.io/using-csv-parse-to-access-stock-data/" title="Using CSV.parse to Access Stock Data">Using CSV.parse to Access Stock Data</a></h4>
        <span>Published on January 29, 2016</span>
      </div><!-- /.list-item -->
    
      <div class="list-item">
        <h4><a href="http://franknowinski.github.io/formatting-the-url-for-the-yahoo-finance-api/" title="Formatting the URL for the Yahoo Finance API">Formatting the URL for the Yahoo Finance API</a></h4>
        <span>Published on January 29, 2016</span>
      </div><!-- /.list-item -->
    
  </div><!-- /.read-more-list -->
</div><!-- /.read-more -->
  </article>
</div><!-- /#main -->

<div class="footer-wrapper">
  <footer role="contentinfo">
    <span>&copy; 2016 Frank Nowisnki.</span>

   <!-- Powered by <a href="http://jekyllrb.com" rel="nofollow">Jekyll</a> using the <a href="https://mademistakes.com/work/hpstr-jekyll-theme/" rel="nofollow">HPSTR Theme</a>.</span> -->

  </footer>
</div><!-- /.footer-wrapper -->

<script src="//ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
<script>window.jQuery || document.write('<script src="http://franknowinski.github.io/assets/js/vendor/jquery-1.9.1.min.js"><\/script>')</script>
<script src="http://franknowinski.github.io/assets/js/scripts.min.js"></script>



	        

</body>
</html>
